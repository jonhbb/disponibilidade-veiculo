const SERVER_URL = "https://vercel.com/jonatans-projects-3b71ae97/servidor-ical/7nNipcXAkKyQj3P24EAvniJpsTQQ";

async function checkAvailability() {
    const dateInput = document.getElementById("date").value;
    if (!dateInput) {
        alert("Por favor, selecione uma data.");
        return;
    }

    const horariosElement = document.getElementById("horarios");
    const loadingElement = document.getElementById("loading");

    horariosElement.style.display = "none";
    loadingElement.style.display = "block";

    try {
        const response = await fetch(SERVER_URL);
        const eventos = await response.json();

        loadingElement.style.display = "none";

        let eventosNoDia = eventos.filter(evento => evento.start.includes(dateInput));

        if (eventosNoDia.length > 0) {
            let horariosOcupados = eventosNoDia.map(evento => `<li>${evento.start} - ${evento.end}</li>`).join("");
            horariosElement.innerHTML = `<strong>Horários Ocupados:</strong><ul>${horariosOcupados}</ul>`;
            horariosElement.className = "horarios ocupado";
            horariosElement.style.display = "block";
        } else {
            horariosElement.innerHTML = "✅ Veículo disponível!";
            horariosElement.className = "horarios disponivel";
            horariosElement.style.display = "block";
        }
    } catch (error) {
        loadingElement.style.display = "none";
        horariosElement.innerHTML = "⚠ Erro ao buscar dados!";
        horariosElement.style.display = "block";
    }
}